# --- Podcast
podcast.calebely.net {
	redir https://podcasters.spotify.com/pod/show/cely717 303
}

# -- Notes
blog.calebely.net {
	# Don't reveal server info
	header -server

	# Compress files on the fly
	encode zstd gzip

	# Define the server root
	root * /var/www/notes/dist

	# Allow .md file extensions to be served as normal files.
	# This is to allow inter-blog links while generator v2 is being developed.
	# TODO: Remove this once generator v2 is done
	uri strip_suffix .md

	# Make the index loadable (don't ask why this is needed, it just is)
	rewrite / index

	# Serve the site
	try_files {path}.html {path} =404
	file_server

	log {
		output file /var/log/caddy/ct-notes.log
		format json
	}
}
